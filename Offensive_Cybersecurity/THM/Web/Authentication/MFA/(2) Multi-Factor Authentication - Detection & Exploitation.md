#MFA #WEB #WebAuthentication

# Common Vulnerabilities in MFA

### Weak OTP Generation Algorithms

*The security of a One-Time Password (OTP) is only as strong as the algorithm used to create it*. 

- If the algorithm is **weak or too predictable**, it can make the attacker's job easier trying to guess the OTP.
- If an algorithm doesn't use truly random seeds, the OTPs generated might follow a pattern, making them more susceptible to prediction.

### Application Leaking the 2FA Token

*If an application handles data poorly or has vulnerabilities like insecure API endpoints, it might accidentally leak the 2FA token in the application's HTTP response.*

- A user, after login, arrives on the 2FA page, the application will trigger an XHR request to an endpoint that issues the OTP. - 
- Sometimes, this XHR request returns the OTP back to the user inside the HTTP response.

- It can be due to :
	- **Server-Side Validation and Return of Sensitive Data**
		- The server validates the OTP, and rather than just confirming success or failure, it returns the OTP itself in the response.
	- **Lack of Proper Security Practices**
	- **Debugging Information Left in Production**

### Brute Forcing the OTP

 *If an attacker can make unlimited guesses, they might eventually get the correct OTP*
 
- trying to crack a safe by turning the dial repeatedly until it clicks open, given enough time and no restrictions, it might just work.

- Some applications use a Auto-Logout Feature for :
	- **Session Invalidation**
	- **Rate-Limiting and Lockout Policies**
	- **Security-Driven Redirection**

Upon failing the 2FA challenge, the application might ***invalidate the user's session as a security measure***, forcing the user to start the authentication process from scratch.

**To beat Auto Logout Automation is key !!**

[[Auto logout OTP Bruteforcer|Auto logout OTP bruteforcer Tool]]

#### Lack of Rate Limiting

*If an attacker can submit multiple guesses in a short amount of time, it increases the likelihood that the attacker will be able to get the correct OTP.*

- this HackerOne [report](https://hackerone.com/reports/121696), the tester was able to report a valid bug since the application doesn't employ rate limiting in the checking of the 2FA code.

### Insecure Coding

*Critical parts of the application (i.e., the dashboard...) can be accessed without fully completing the authentication process.* 

-  **Bypass the 2FA mechanism entirely** and gain access to the dashboard or other sensitive areas without entering the OTP (One-Time Password). 
- This is often due to improper session management, poor access control checks, or incorrectly implemented logic that fails to enforce the 2FA requirement.