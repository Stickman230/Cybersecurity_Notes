#Session #WEB  #WebAuthentication
# Common Session Vulnerabilities

## Session Creation
*Session creation is where the most vulnerabilities can creep in.*

**Weak Session Values**
- Framework have a tendency to counter this
- If a custom session creation mechanism has been implemented, there is a good chance that the session values may be guessable. 

- ==EX:==  Simply base64 encodes the username as the session value.

**Controllable Session Values**
- If security measures are not enforced, such as verifying the token's signature or ensuring that the signature itself was created securely, a threat actor would be able to generate their own token. 

- ==EX:== Using JWT without signature

**Session Fixation**
- If a web application already gave you a session before authentication
- If your session value is not adequately rotated once you authenticate, a suitably positioned threat actor could record it when you are still unauthenticated and wait for you to authenticate to gain access to your session.  

**Insecure Session Transmission**
- It is common for the authentication server and the application servers to be distinct. 
- Think about things like Single Sign-On (SSO) solutions. One application is used for authentication to several other web applications. 
- In order for this process to work, 
	- your session material must be transferred from the authentication server to the application server via your browser. 
	- The most common is an insecure redirect where the threat actor can control the URL where you will be redirected to post-authentication. 

- ==EX:== Oracle's SSO solution had a [massive bug that allowed for this to happen](https://krbtgt.pw/oracle-oam-10g-session-hijacking/).  

## Session Tracking
*Session tracking is the second largest culprit of vulnerabilities. Let's take a look.*

**Authorization Bypass**
- Authorisation bypasses occur when there aren't sufficient checks being performed on whether a user is allowed to perform the action they requested.
	- *Vertical bypass* - You can perform an action that is reserved for a more privileged user
	- *Horizontal bypass*- You can perform an action you are allowed to perform, but on a dataset that you should not be allowed to perform the action on  

**Insufficient Logging**
-  While a lot of logging will occur at an infrastructure level, application logging can be crucial to understanding what went wrong.

***Simply logging rejected actions is not sufficient to paint the picture.***  

## Session Expiry
*Session expiry only has a single vulnerability, which is when the expiry time for sessions are excessive*

-  We need to make sure that our session expiry time takes into consideration our specific application's use case. A banking application should have a shorter session lifetime than your webmail client.

Furthermore, in the event of long-life sessions, such as those for a webmail client, the session itself should attest to the location where it is used. If this location changes (which could be an indication of session hijacking), the session should be terminated.  

## Session Termination

- Sessions are *not properly terminated server-side when the logout action is performed*. 
- In that case, even if the user became aware of the issue, without the ability to invalidate the session server-side, there isn't a method for the user to flush the access of the threat actor. 
- However, this can be quite an issue for tokens where the lifetime of the token is embedded in the token itself. In these cases, the token can be added to a blocklist to be verified against. 