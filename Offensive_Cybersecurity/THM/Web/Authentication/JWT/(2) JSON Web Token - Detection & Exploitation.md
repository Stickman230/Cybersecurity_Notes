#JWT #WEB #WebAuthentication

# Sensitive Information Disclosure

- *Cookie-based* session management approach is using the server-side session to store several parameters.
	- In PHP, you can use $SESSION['var']=data to store a value associated with the user's session. 

- *Tokens*, the claims are exposed as the entire JWT is sent client-side.

It can lead to **sensitive information disclosure** :

- *Credential disclosure* with the password hash, or even worse, the clear-text password being sent as a claim.
- *Exposure of internal network information* such as the private IP or hostname of the authentication server.

---
# Signature validation mistakes

### Not Verifying the Signature

- The first issue with signature validation is when there is *no signature validation*. 
	- If the server does not verify the signature of the JWT, then it is possible to modify the claims in the JWT to whatever you prefer them to be.
==EX:== 

With signature : `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.KMUFsIDTnFmyG3nMiGM6H9FNFUROf3wh7SmqJp-QV30`

Without signature : `eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.`

***Leave only the dot for bypass***

### Downgrading to None

-  JWTs support the `none` signing algorithm, which effectively means that no signature is used with the JWT. 
	- In that case, you can simply change the algorithm specified in your JWT as `none`, which would then cause the library used for signature verification to always return true, thus allowing you again to forge any claims within your token.
==EX:==

With signature algorithm set to **none**:`eyJhbGciOiJub25lIiwidHlwIjoiSldUIn0.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWUsImlhdCI6MTUxNjIzOTAyMn0.`

### Weak Symmetric Secrets

- If a symmetric signing algorithm is used, the security of the JWT relies on the strength and entropy of the secret used. I
	- f a weak secret is used, it may be possible to perform offline cracking to recover the secret. 
==EX:==

1. Save the JWT to a text file called jwt.txt.
2. Download a common JWT secret list.  You can use [JWT secret cracking lists](https://raw.githubusercontent.com/wallarm/jwt-secrets/master/jwt.secrets.list)Â 
3. Use Hashcat to crack the secret using `hashcat -m 16500 -a 0 jwt.txt jwt.secrets.list`