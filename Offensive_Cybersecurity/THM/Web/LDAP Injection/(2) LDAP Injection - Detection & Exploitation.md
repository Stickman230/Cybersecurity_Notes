
# Discovery

***LDAP Services*** can be accessible on ports :
- **389** (for unencrypted or StartTLS connections) 
- **636** (for SSL/TLS connections)

---
# Exploitation

## Common Attack Vectors

1. **Authentication Bypass:** Modifying LDAP authentication queries to log in as another user without knowing their password.
2. **Unauthorized Data Access:** Altering LDAP search queries to retrieve sensitive information not intended for the attacker's access.
3. **Data Manipulation:** Injecting queries that modify the LDAP directory, such as adding or modifying user attributes

## Authentication Bypass Techniques
### Tautology-Based Injection

A query fetching the username and password of a user for auth:
```php
(&(uid=USER)(userPassword=PASS))
```

Could be manipulated to always be true:
```php
(&(uid=*)(|(&)(userPassword=pwd)))
```

1. `(uid=*)`: This part of the filter matches any entry with a `uid` attribute, essentially all users, because the wildcard `*` matches any value.
2. `(|(&)(userPassword=pwd))`: The OR (`|`) operator, meaning that any of the two conditions enclosed needs to be true for the filter to pass. 
3. In LDAP, an empty AND (`(&)`) condition is always considered true. The other condition checks if the `userPassword` attribute matches the value `pwd`, which can fail if the user is not using `pwd` as their password.

### Wildcard Injection

Wildcards (`*`) are used in LDAP queries to match any sequence of characters
```php
(&(uid=USER)(userPassword=PASS))
```

Using a `*` for `{userInput}` and `{passwordInput}` does not validate the content of the password or user field against a specific expected value. Instead, it only **checks for the presence** of the `userPassword` attribute, regardless of its content.