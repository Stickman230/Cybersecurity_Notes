#eJPT #INE #VulnerabilityAssesement


| COMMAND        | FUNCTION                                                  |
| -------------- | --------------------------------------------------------- |
| *searchsploit* | search exploit db                                         |
| davtest        | - Used to scan, authenticate and exploit a WebDAV server. |
|                |                                                           |

# History

● **Microsoft Windows is the dominant operating system worldwide** with a market share >=70% as of 2021.
● The popularity and deployment of Windows by individuals and companies makes it a prime target for attackers given the threat surface.
● Over the last 15 years, Windows has had its fair share of severe vulnerabilities, ranging from *MS08-067(Conflicker)* to *MS17-010 (EternalBlue)*.

By default, *Windows is not configured to run securely* and require a proactive implementation of security practices in order to configure Windows to run securely.

#### Types of Windows Vulnerabilities

● **Information disclosure** - Vulnerability that allows an attacker to access confidential data.

● **Buffer overflows** - Caused by a programming error, allows attackers to write data to a buffer and overrun the allocated buffer, consequently writing data to allocated memory addresses.

● **Remote code execution** - Vulnerability that allows an attacker to remotely execute code on the target system.

● **Privilege** escalation - Vulnerability that allows an attacker to elevate their privileges after initial compromise.

● **Denial of Service (DOS)** - Vulnerability that allows an attacker to consume a system/host’s resources (CPU, RAM, Network etc) consequently preventing the system from functioning normally.

---

# Frequently exploited window services

| Protocol/Service                                   | Ports              | Purpose                                                                                                                                                             |
| -------------------------------------------------- | ------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Microsoft IIS (Internet Information<br>Services)   | TCP ports 80/443   | Proprietary web server software developed by Microsoft that runs on<br>Windows.                                                                                     |
| WebDAV (Web Distributed Authoring &<br>Versioning) | TCP ports 80/443   | HTTP extension that allows clients to update, delete, move and copy files<br>on a web server. WebDAV is used to enable a web server to act as a file<br>server.<br> |
| SMB/CIFS (Server Message Block<br>Protocol)        | TCP port 445       | Network file sharing protocol that is used to facilitate the sharing of files<br>and peripherals between computers on a local network (LAN).                        |
| RDP(Remote Desktop Protocol)                       | TCP port 3389      | Proprietary GUI remote access protocol developed by Microsoft and is used<br>to remotely authenticate and interact with a Windows system.                           |
| WinRM (Windows Remote Management<br>Protocol)      | TCP ports 5986/443 | Windows remote management protocol that can be used to facilitate<br>remote access with Windows systems.                                                            |

---
# Exploiting with Metasploit

db_autopwn : https://github.com/hahwul/metasploit-autopwn

can be installed and loaded in metasploit

# Microsoft IIS

*IIS (Internet Information Services) is a proprietary extensible web server software developed by Microsoft* for use with the Windows NT family.

● It can be used to host websites/web apps and provides administrators with a robust GUI for managing websites.
● IIS can be used to host both static and dynamic web pages developed in ASP.NET and PHP.
● Typically configured to run on ports 80/443.
● Supported executable file extensions:
+ .asp
+ .aspx
+ .config
+ .php
  
# WebDAV

*WebDAV (Web-based Distributed Authoring and Versioning) is a set of extensions to the HTTP protocol which allow users to collaboratively edit and manage files on remote web servers.*

● WebDAV essentially enables a web server to function as a file server for collaborative authoring.
● WebDAV runs on top Microsoft IIS on ports 80/443.
● In order to connect to a WebDAV server, you will need to provide legitimate credentials. This is because WebDAV implements authentication in the form of a username and password

The first step of the exploitation process will involve **identifying whether WebDAV has been configured to run on the IIS web server.**
- We can perform a brute-force attack 
- After obtaining legitimate credentials, we can authenticate with the WebDAV server and upload a malicious *.asp* payload 